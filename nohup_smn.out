=========
train batch size : 50
keep_words 17904 / 78008 = 0.2295
5346
Train: [1/2][1/3474] curr loss: 0.418, Loss: 0.418, Acc: 0.980
Train: [1/2][696/3474] curr loss: 0.283, Loss: 0.351, Acc: 0.896
Train: [1/2][1391/3474] curr loss: 0.434, Loss: 0.338, Acc: 0.897
Train: [1/2][2086/3474] curr loss: 0.313, Loss: 0.329, Acc: 0.898
Train: [1/2][2781/3474] curr loss: 0.377, Loss: 0.323, Acc: 0.898
--------------------------------------------------------------------------------
Valid: [end of epoch  1|time: 364.24s| R1:0.303| R2:0.525| R5:0.852| Acc:0.895
--------------------------------------------------------------------------------
Train: [2/2][1/3474] curr loss: 0.158, Loss: 0.158, Acc: 0.980
Train: [2/2][696/3474] curr loss: 0.229, Loss: 0.295, Acc: 0.897
Train: [2/2][1391/3474] curr loss: 0.383, Loss: 0.288, Acc: 0.899
Train: [2/2][2086/3474] curr loss: 0.300, Loss: 0.284, Acc: 0.899
Train: [2/2][2781/3474] curr loss: 0.344, Loss: 0.281, Acc: 0.899
--------------------------------------------------------------------------------
Valid: [end of epoch  2|time: 359.09s| R1:0.340| R2:0.536| R5:0.856| Acc:0.889
--------------------------------------------------------------------------------
=========================================================================================
Test: [R1: 0.355 | R2: 0.567 | R5: 0.870 | Acc: 0.889




########################################################################################
################################ the best baseline with paper configs #########################################################
##########################################################################################
with setting config params from msdialog paper response rank with deep matching network:

keep_words 17904 / 78008 = 0.2295
5346
Train: [1/2][1/3474] curr loss: 0.586, Loss: 0.586, Acc: 0.940
Train: [1/2][696/3474] curr loss: 0.254, Loss: 0.340, Acc: 0.898
Train: [1/2][1391/3474] curr loss: 0.391, Loss: 0.327, Acc: 0.899
Train: [1/2][2086/3474] curr loss: 0.294, Loss: 0.320, Acc: 0.899
Train: [1/2][2781/3474] curr loss: 0.374, Loss: 0.316, Acc: 0.899
--------------------------------------------------------------------------------
Valid: [end of epoch  1|time: 688.99s| R1:0.301| R2:0.507| R5:0.855| Acc:0.897
--------------------------------------------------------------------------------
Train: [2/2][1/3474] curr loss: 0.162, Loss: 0.162, Acc: 0.980
Train: [2/2][696/3474] curr loss: 0.209, Loss: 0.291, Acc: 0.898
Train: [2/2][1391/3474] curr loss: 0.374, Loss: 0.282, Acc: 0.900
Train: [2/2][2086/3474] curr loss: 0.314, Loss: 0.278, Acc: 0.900
Train: [2/2][2781/3474] curr loss: 0.343, Loss: 0.275, Acc: 0.901
--------------------------------------------------------------------------------
Valid: [end of epoch  2|time: 694.44s| R1:0.326| R2:0.535| R5:0.862| Acc:0.893
--------------------------------------------------------------------------------
=========================================================================================
Test: [R1: 0.349 | R2: 0.569 | R5: 0.867 | Acc: 0.893



epoch : 6
=========
keep_words 17904 / 78008 = 0.2295
5346
Train: [1/6][1/3474] curr loss: 0.586, Loss: 0.586, Acc: 0.940
Train: [1/6][696/3474] curr loss: 0.254, Loss: 0.340, Acc: 0.898
Train: [1/6][1391/3474] curr loss: 0.391, Loss: 0.327, Acc: 0.899
Train: [1/6][2086/3474] curr loss: 0.294, Loss: 0.320, Acc: 0.899
Train: [1/6][2781/3474] curr loss: 0.374, Loss: 0.316, Acc: 0.899
--------------------------------------------------------------------------------
Valid: [end of epoch  1|time: 707.42s| R1:0.301| R2:0.507| R5:0.855| Acc:0.897
--------------------------------------------------------------------------------
Train: [2/6][1/3474] curr loss: 0.162, Loss: 0.162, Acc: 0.980
Train: [2/6][696/3474] curr loss: 0.209, Loss: 0.291, Acc: 0.898
Train: [2/6][1391/3474] curr loss: 0.374, Loss: 0.282, Acc: 0.900
Train: [2/6][2086/3474] curr loss: 0.314, Loss: 0.278, Acc: 0.900
Train: [2/6][2781/3474] curr loss: 0.343, Loss: 0.275, Acc: 0.901
--------------------------------------------------------------------------------
Valid: [end of epoch  2|time: 732.29s| R1:0.326| R2:0.535| R5:0.862| Acc:0.893
--------------------------------------------------------------------------------
Train: [3/6][1/3474] curr loss: 0.111, Loss: 0.111, Acc: 0.960
Train: [3/6][696/3474] curr loss: 0.141, Loss: 0.248, Acc: 0.905
Train: [3/6][1391/3474] curr loss: 0.335, Loss: 0.235, Acc: 0.909
Train: [3/6][2086/3474] curr loss: 0.292, Loss: 0.230, Acc: 0.911
Train: [3/6][2781/3474] curr loss: 0.302, Loss: 0.225, Acc: 0.913
--------------------------------------------------------------------------------
Valid: [end of epoch  3|time: 695.97s| R1:0.295| R2:0.499| R5:0.831| Acc:0.886
--------------------------------------------------------------------------------
Train: [4/6][1/3474] curr loss: 0.069, Loss: 0.069, Acc: 0.980
Train: [4/6][696/3474] curr loss: 0.061, Loss: 0.186, Acc: 0.929
Train: [4/6][1391/3474] curr loss: 0.224, Loss: 0.172, Acc: 0.934
Train: [4/6][2086/3474] curr loss: 0.321, Loss: 0.166, Acc: 0.936
Train: [4/6][2781/3474] curr loss: 0.238, Loss: 0.160, Acc: 0.938
--------------------------------------------------------------------------------
Valid: [end of epoch  4|time: 696.90s| R1:0.285| R2:0.476| R5:0.797| Acc:0.881
--------------------------------------------------------------------------------
Train: [5/6][1/3474] curr loss: 0.075, Loss: 0.075, Acc: 0.960
Train: [5/6][696/3474] curr loss: 0.072, Loss: 0.125, Acc: 0.953
Train: [5/6][1391/3474] curr loss: 0.122, Loss: 0.115, Acc: 0.957
Train: [5/6][2086/3474] curr loss: 0.265, Loss: 0.109, Acc: 0.959
Train: [5/6][2781/3474] curr loss: 0.103, Loss: 0.105, Acc: 0.960
--------------------------------------------------------------------------------
Valid: [end of epoch  5|time: 702.37s| R1:0.263| R2:0.450| R5:0.786| Acc:0.866
--------------------------------------------------------------------------------
Train: [6/6][1/3474] curr loss: 0.015, Loss: 0.015, Acc: 1.000
Train: [6/6][696/3474] curr loss: 0.068, Loss: 0.083, Acc: 0.969
Train: [6/6][1391/3474] curr loss: 0.100, Loss: 0.079, Acc: 0.970
Train: [6/6][2086/3474] curr loss: 0.126, Loss: 0.075, Acc: 0.972
Train: [6/6][2781/3474] curr loss: 0.067, Loss: 0.073, Acc: 0.973
--------------------------------------------------------------------------------
Valid: [end of epoch  6|time: 723.26s| R1:0.273| R2:0.445| R5:0.762| Acc:0.867
--------------------------------------------------------------------------------
=========================================================================================
Test: [R1: 0.349 | R2: 0.569 | R5: 0.867 | Acc: 0.893


bade inke akharin ezhare context ke khali bud ro hazf kardam:

keep_words 17904 / 78008 = 0.2295
5346
Train: [1/3][1/3474] curr loss: 0.586, Loss: 0.586, Acc: 0.940
Train: [1/3][696/3474] curr loss: 0.254, Loss: 0.340, Acc: 0.898
Train: [1/3][1391/3474] curr loss: 0.391, Loss: 0.327, Acc: 0.899
Train: [1/3][2086/3474] curr loss: 0.294, Loss: 0.320, Acc: 0.899
Train: [1/3][2781/3474] curr loss: 0.374, Loss: 0.316, Acc: 0.899
--------------------------------------------------------------------------------
Valid: [end of epoch  1|time: 950.31s| R1:0.302| R2:0.507| R5:0.856| Acc:0.897
--------------------------------------------------------------------------------
Train: [2/3][1/3474] curr loss: 0.162, Loss: 0.162, Acc: 0.980
Train: [2/3][696/3474] curr loss: 0.211, Loss: 0.291, Acc: 0.898
Train: [2/3][1391/3474] curr loss: 0.370, Loss: 0.282, Acc: 0.900
Train: [2/3][2086/3474] curr loss: 0.315, Loss: 0.278, Acc: 0.900
Train: [2/3][2781/3474] curr loss: 0.341, Loss: 0.275, Acc: 0.900
--------------------------------------------------------------------------------
Valid: [end of epoch  2|time: 958.70s| R1:0.330| R2:0.534| R5:0.863| Acc:0.893
--------------------------------------------------------------------------------
Train: [3/3][1/3474] curr loss: 0.109, Loss: 0.109, Acc: 0.960
Train: [3/3][696/3474] curr loss: 0.142, Loss: 0.248, Acc: 0.905
Train: [3/3][1391/3474] curr loss: 0.334, Loss: 0.235, Acc: 0.909
Train: [3/3][2086/3474] curr loss: 0.291, Loss: 0.230, Acc: 0.911
Train: [3/3][2781/3474] curr loss: 0.303,

Valid: [end of epoch  3|time: 953.25s| R1:0.296| R2:0.503| R5:0.831| Acc:0.886
--------------------------------------------------------------------------------
=========================================================================================
Test: [R1: 0.350 | R2: 0.562 | R5: 0.864 | Acc: 0.892